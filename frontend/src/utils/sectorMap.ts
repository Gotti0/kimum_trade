/**
 * WICS 업종분류 매핑 (국내 종목) + 글로벌 ETF 카테고리 매핑
 *
 * - 국내: 종목코드(6자리) → WICS 소분류 섹터명
 * - 글로벌: ASSET_CLASS_REGISTRY 의 category 를 재사용
 *
 * 이 매핑은 1차 규칙기반 분류용이며, LLM 프롬프트에 섹터 정보를 포함하여
 * "반도체 ≈ AI 인프라" 같은 시멘틱 추론은 LLM이 보완합니다.
 *
 * 매핑에 없는 종목은 '미분류'로 표시되며, 프롬프트에서 LLM에 분류를 위임합니다.
 */

// ═══════════════════════════════════════════════════
//  국내 종목코드 → WICS 섹터 매핑
// ═══════════════════════════════════════════════════

export const WICS_SECTOR_MAP: Record<string, string> = {
    // ── 반도체 ──
    '005930': '반도체',          // 삼성전자
    '000660': '반도체',          // SK하이닉스
    '042700': '반도체',          // 한미반도체
    '080220': '반도체',          // 제주반도체
    '320000': '반도체',          // 한울반도체
    '399720': '반도체',          // 가온칩스
    '330860': '반도체',          // 네패스아크
    '064290': '반도체',          // 인텍플러스
    '043260': '반도체',          // 성호전자 (휴대폰 수동부품/반도체)
    '456010': '반도체',          // 아이씨티케이
    '424980': '반도체',          // 마이크로투나노
    '017010': '반도체',          // 대한광통신
    '036830': '반도체',          // 솔브레인홀딩스
    '357780': '반도체',          // 솔브레인
    '191410': '반도체',          // 육일씨엔에쓰
    '166090': '반도체',          // 하나머티리얼즈
    '950140': '반도체',          // 잉크테크
    '240810': '반도체',          // 원익IPS
    '058470': '반도체',          // 리노공업
    '403870': '반도체',          // HPSP
    '278990': '반도체',          // EMB
    '302920': '반도체',          // 더블유씨피
    '108320': '반도체',          // LX세미콘 (DDI 팹리스)

    // ── 2차전지/배터리 ──
    '373220': '2차전지',         // LG에너지솔루션
    '006400': '2차전지',         // 삼성SDI
    '051910': '2차전지',         // LG화학
    '247540': '2차전지',         // 에코프로비엠
    '086520': '2차전지',         // 에코프로
    '336370': '2차전지',         // 솔루스첨단소재
    '073570': '2차전지',         // 리튬포어스
    '101670': '2차전지',         // 하이드로리튬
    '340930': '2차전지',         // 유일에너테크
    '475150': '2차전지',         // SK이터닉스
    '003670': '2차전지',         // 포스코퓨처엠

    // ── 자동차/전기차 ──
    '005380': '자동차',          // 현대차
    '000270': '자동차',          // 기아
    '012330': '자동차',          // 현대모비스
    '018880': '자동차',          // 한온시스템
    '204320': '자동차',          // 만도
    '161390': '자동차',          // 한국타이어앤테크놀로지
    '001380': '자동차',           // SG글로벌 (자동차부품)

    // ── IT/소프트웨어 ──
    '035720': 'IT/소프트웨어',    // 카카오
    '035420': 'IT/소프트웨어',    // NAVER
    '259960': 'IT/소프트웨어',    // 크래프톤
    '263750': 'IT/소프트웨어',    // 펄어비스
    '036570': 'IT/소프트웨어',    // 엔씨소프트
    '251270': 'IT/소프트웨어',    // 넷마블
    '079940': 'IT/소프트웨어',    // 가비아
    '054920': 'IT/소프트웨어',    // 한컴위드
    '053280': 'IT/소프트웨어',    // 예스24
    '123570': 'IT/소프트웨어',    // 이엠넷
    '393210': 'IT/소프트웨어',    // 토마토시스템
    '450520': 'IT/소프트웨어',    // 인스웨이브
    '411080': 'IT/소프트웨어',    // 샌즈랩
    '443670': 'IT/소프트웨어',    // 에스피소프트
    '163730': 'IT/소프트웨어',    // 핑거
    '086960': 'IT/소프트웨어',    // MDS테크
    '110990': 'IT/소프트웨어',    // 디아이티
    '263800': 'IT/소프트웨어',    // 데이타솔루션
    '290560': 'IT/소프트웨어',    // 신시웨이
    '317530': 'IT/소프트웨어',    // 캐리소프트
    '313760': 'IT/소프트웨어',    // 캐리
    '377030': 'IT/소프트웨어',    // 비트맥스
    '115500': 'IT/소프트웨어',    // 케이씨에스
    '047080': 'IT/소프트웨어',    // 한빛소프트
    '124500': 'IT/소프트웨어',    // 아이티센글로벌

    // ── 통신 ──
    '017670': '통신',            // SK텔레콤
    '030200': '통신',            // KT
    '032640': '통신',            // LG유플러스

    // ── 바이오/제약 ──
    '185750': '바이오/제약',      // 종근당
    '207940': '바이오/제약',      // 삼성바이오로직스
    '068270': '바이오/제약',      // 셀트리온
    '326030': '바이오/제약',      // SK바이오팜
    '950160': '바이오/제약',      // 코오롱티슈진
    '000250': '바이오/제약',      // 삼천당제약
    '032300': '바이오/제약',      // 한국파마
    '067080': '바이오/제약',      // 대화제약
    '046210': '바이오/제약',      // HLB파나진
    '047920': '바이오/제약',      // HLB제약
    '214260': '바이오/제약',      // 라파스
    '217730': '바이오/제약',      // 강스템바이오텍
    '246250': '바이오/제약',      // 에스엘에스바이오
    '291650': '바이오/제약',      // 압타머사이언스
    '294090': '바이오/제약',      // 이오플로우
    '299660': '바이오/제약',      // 셀리드
    '303030': '바이오/제약',      // 지니틱스
    '304840': '바이오/제약',      // 피플바이오
    '378800': '바이오/제약',      // 샤페론
    '389470': '바이오/제약',      // 인벤티지랩
    '445680': '바이오/제약',      // 큐리옥스바이오시스템즈
    '456070': '바이오/제약',      // 이엔셀
    '180400': '바이오/제약',      // DXVX
    '188260': '바이오/제약',      // 세니젠
    '372910': '바이오/제약',      // 한컴라이프케어
    '114450': '바이오/제약',      // 그린생명과학
    '073640': '바이오/제약',      // 테라사이언스
    '002720': '바이오/제약',      // 국제약품
    '003090': '바이오/제약',      // 대웅
    '239610': '바이오/제약',      // 에이치엘사이언스
    '065170': '바이오/제약',      // 비엘팜텍
    '221800': '바이오/제약',      // 유투바이오
    '417840': '바이오/제약',      // 저스템

    // ── 금융/증권/보험 ──
    '105560': '금융',            // KB금융
    '055550': '금융',            // 신한지주
    '086790': '금융',            // 하나금융지주
    '316140': '금융',            // 우리금융지주
    '024110': '금융',            // 기업은행
    '006220': '금융',            // 제주은행
    '000540': '금융',            // 흥국화재
    '027360': '금융',            // 아주IB투자
    '006800': '금융',            // 미래에셋증권

    // ── 건설/건자재 ──
    '000720': '건설',            // 현대건설
    '047040': '건설',            // 대우건설
    '001470': '건설',            // 삼부토건
    '001840': '건설',            // 이화공영
    '002410': '건설',            // 범양건영
    '351330': '건설',            // 이삭엔지니어링
    '452280': '건설',            // 한선엔지니어링

    // ── 철강/금속/소재 ──
    '005490': '철강/금속',       // POSCO홀딩스
    '004100': '철강/금속',       // 태양금속
    '024840': '철강/금속',       // KBI메탈
    '024740': '철강/금속',       // 한일단조
    '092790': '철강/금속',       // 넥스틸
    '006340': '철강/금속',       // 대원전선
    '294630': '철강/금속',       // 서남
    '062970': '철강/금속',       // 한국첨단소재
    '130500': '철강/금속',       // GH신소재

    // ── 화학/소재 ──
    '000390': '화학',            // 삼화페인트
    '457190': '화학',            // 이수스페셜티케미컬 (정밀화학/전고체 소재)
    '024890': '화학',            // 대원화성
    '078140': '화학',            // 대봉엘에스
    '004540': '화학',            // 깨끗한나라

    // ── 에너지/유틸리티 ──
    '000440': '에너지',          // 중앙에너비스 (석유류 판매/유통)
    '004090': '에너지',          // 한국석유
    '024060': '에너지',          // 흥구석유
    '322000': '에너지',          // HD현대에너지솔루션
    '229640': '에너지',          // LS에코에너지
    '130660': '에너지',          // 한전산업
    '017510': '에너지',          // 세명전기
    '019990': '에너지',          // 에너토크

    // ── 기계/장비 ──
    '010100': '기계/장비',       // 한국무브넥스
    '008830': '기계/장비',       // 대동기어
    '025560': '기계/장비',       // 미래산업
    '241770': '기계/장비',       // 메카로
    '458650': '기계/장비',       // 성우
    '460940': '기계/장비',       // 피앤에스로보틱스
    '007110': '기계/장비',       // 일신석재
    '009730': '기계/장비',       // 이렘
    '317850': '기계/장비',       // 대모 (굴착기 어태치먼트)

    // ── 로봇/자동화 ──
    '277810': '로봇',            // 레인보우로보틱스

    // ── 전자부품/디스플레이 ──
    '066570': '전자부품',        // LG전자
    '009150': '전자부품',        // 삼성전기
    '034220': '전자부품',        // LG디스플레이
    '065350': '전자부품',        // 신성델타테크
    '045660': '전자부품',        // 에이텍
    '077500': '전자부품',        // 유니퀘스트
    '069540': '전자부품',        // 빛과전자
    '321370': '전자부품',        // 센서뷰
    '388790': '전자부품',        // 라이콤
    '389020': '전자부품',        // 자람테크놀로지
    '317120': '전자부품',        // 라닉스
    '113810': '전자부품',        // 디젠스
    '043090': '전자부품',        // 더테크놀로지
    '446540': '전자부품',        // 메가터치
    '204270': '전자부품',        // 제이앤티씨
    '033540': '전자부품',        // 파라텍
    '079190': '전자부품',        // 케스피온 (RF부품)

    // ── 통신장비/위성 ──
    '211270': '통신장비',        // AP위성
    '028080': '통신장비',        // 휴맥스홀딩스

    // ── 지주회사/복합기업 ──
    '030530': '지주회사',        // 원익홀딩스
    '000680': '유통/소비재',     // LS네트웍스 (유통/상사 주력)
    '004870': '지주회사',        // 티웨이홀딩스

    // ── 식품/음료 ──
    '003230': '식품',            // 삼양식품
    '003960': '식품',            // 사조대림
    '036580': '식품',            // 팜스코
    '043650': '식품',            // 국순당
    '024940': '식품',            // PN풍년

    // ── 유통/소비재 ──
    '014990': '유통/소비재',      // 인디에프
    '003350': '유통/소비재',      // 한국화장품제조
    '257720': '유통/소비재',      // 실리콘투 (뷰티 유통)

    // ── 여행/레저 ──
    '094850': '여행/레저',       // 참좋은여행

    // ── 미디어/엔터 ──
    '036000': '미디어/엔터',     // 예림당
    '363260': '미디어/엔터',     // 모비데이즈
    '041510': '미디어/엔터',     // SM엔터테인먼트
    '352820': '미디어/엔터',     // 하이브

    // ── 헬스케어/의료기기 ──
    '263700': '헬스케어',        // 케어랩스
    '451250': '헬스케어',        // 삐아

    // ── 환경/폐기물 ──
    '128540': '환경',            // 에코캡
    '097870': '환경',            // 효성오앤비

    // ── 방산/항공 ──
    '012450': '방산',            // 한화에어로스페이스
    '047810': '방산',            // 한국항공우주

    // ── 운송 (해운/항공) ──
    '011200': '운송',            // HMM (해운)
    '003490': '운송',            // 대한항공 (항공)

    // ── 기타 ──
    '002630': '기타',            // 오리엔트바이오
    '002680': '기타',            // 한탑
    '012170': '기타',            // 아센디오
    '012800': '기타',            // 대창
    '065500': '기타',            // 오리엔트정공
    '066790': '기타',            // 씨씨에스
    '090080': '기타',            // 평화산업
    '102370': '기타',            // 케이옥션
    '121850': '기타',            // 코이즈
    '123010': '기타',            // 아이윈플러스
    '147830': '기타',            // 제룡산업
    '160190': '기타',            // 하이젠알앤엠
    '219420': '기타',            // 링크제니시스
    '219550': '기타',            // 디와이디
    '232140': '기타',            // 와이씨
    '239340': '기타',            // 이스트에이드
    '255220': '기타',            // SG
    '260970': '기타',            // 에스앤디
    '306620': '기타',            // 지아이에스
    '355690': '기타',            // 에이텀
    '368600': '기타',            // 아이씨에이치
    '416180': '기타',            // 신성에스티
    '452160': '기타',            // 제이엔비
    '452400': '기타',            // 이닉스
    '900270': '기타',            // 헝셩그룹
    '900290': '기타',            // GRT

    // ── KOSPI 대형주 추가 (유니버스에 자주 등장) ──
    '005935': '반도체',          // 삼성전자우
    '051900': '유통/소비재',      // LG생활건강
    '028260': '지주회사',         // 삼성물산 (건설/상사/지주)
    '034730': '지주회사',         // SK
    '003550': '지주회사',         // LG
    '015760': '에너지',          // 한국전력
    '032830': '금융',            // 삼성생명
    '034020': '기계/장비',       // 두산에너빌리티 (원자력/발전장비)
    '016360': '금융',            // 삼성증권
    '009540': '기계/장비',       // HD한국조선해양 (조선)
    '010130': '철강/금속',       // 고려아연
    '011170': '화학',            // 롯데케미칼
    '096770': '2차전지',         // SK이노베이션
    '010950': '에너지',          // S-Oil (정유)
    '033780': '식품',            // KT&G (담배/소비재)
    '011070': '전자부품',        // LG이노텍
    '267260': '지주회사',         // HD현대
    '138040': '금융',            // 메리츠금융지주
    '180640': '지주회사',         // 한진칼
    '329180': '기계/장비',       // HD현대중공업 (조선/중공업)
    '006360': '건설',            // GS건설
    '000810': '금융',            // 삼성화재
    '187660': '자동차',          // 현대ADM
    '032820': '에너지',          // 우리기술
    '347700': 'IT/소프트웨어',    // 스피어

    // ── 국내 ETF (개별주식이 아닌 ETF — 별도 분리) ──
    '488080': '반도체 (ETF)',    // TIGER 반도체TOP10레버리지
};

/**
 * 국내 ETF 종목코드 집합 — 개별 주식과 구분하여
 * MDD 계산, 변동성 관리 등에서 별도 처리할 때 사용합니다.
 */
export const KR_ETF_CODES: ReadonlySet<string> = new Set([
    '488080', // TIGER 반도체TOP10레버리지
]);

/** 종목코드가 국내 ETF인지 여부를 반환합니다. */
export const isKrETF = (stkCd: string): boolean => KR_ETF_CODES.has(stkCd);

/**
 * 국내 종목코드로 WICS 섹터를 조회합니다.
 * 매핑에 없는 종목은 '미분류'를 반환합니다.
 */
export const getKrSector = (stkCd: string): string =>
    WICS_SECTOR_MAP[stkCd] ?? '미분류';

// ═══════════════════════════════════════════════════
//  글로벌 ETF 카테고리 매핑
// ═══════════════════════════════════════════════════

/**
 * 글로벌 ETF 티커 → 자산군 카테고리 매핑
 * MomentumPanel.tsx의 ASSET_CLASS_REGISTRY와 동기화.
 */
export const GLOBAL_ETF_CATEGORY_MAP: Record<string, { category: string; label: string; description: string }> = {
    // 주식
    SPY: { category: '주식', label: '미국 대형주', description: 'S&P 500' },
    IWM: { category: '주식', label: '미국 소형주', description: 'Russell 2000' },
    EFA: { category: '주식', label: '선진국 (미국 제외)', description: 'MSCI EAFE' },
    EEM: { category: '주식', label: '신흥국', description: 'MSCI EM' },
    EWY: { category: '주식', label: '한국 주식', description: 'MSCI Korea' },
    // 채권
    AGG: { category: '채권', label: '미국 채권 (종합)', description: 'US Aggregate Bond' },
    IEF: { category: '채권', label: '미국 국채 (중기)', description: '7-10Y Treasury' },
    TLT: { category: '채권', label: '미국 국채 (장기)', description: '20Y+ Treasury' },
    TIP: { category: '채권', label: '물가연동채', description: 'TIPS' },
    // 실물자산
    VNQ: { category: '대체투자', label: '글로벌 리츠', description: 'US REITs' },
    DBC: { category: '대체투자', label: '원자재', description: 'Commodity Index' },
    GLD: { category: '대체투자', label: '금', description: 'Gold' },
    // 현금등가
    SHY: { category: '현금등가', label: '단기 국채', description: '1-3Y Treasury' },
};

/**
 * 글로벌 ETF 티커로 카테고리명을 조회합니다.
 */
export const getGlobalCategory = (ticker: string): string =>
    GLOBAL_ETF_CATEGORY_MAP[ticker]?.category ?? '미분류';

/**
 * 글로벌 ETF 티커로 한글 라벨을 조회합니다.
 */
export const getGlobalLabel = (ticker: string): string =>
    GLOBAL_ETF_CATEGORY_MAP[ticker]?.label ?? ticker;

// ═══════════════════════════════════════════════════
//  섹터 집계 유틸리티
// ═══════════════════════════════════════════════════

/** 모든 고유 국내 섹터 목록 */
export const KR_SECTORS = [...new Set(Object.values(WICS_SECTOR_MAP))].sort();

/** 모든 고유 글로벌 카테고리 목록 */
export const GLOBAL_CATEGORIES = [...new Set(
    Object.values(GLOBAL_ETF_CATEGORY_MAP).map(v => v.category)
)].sort();
